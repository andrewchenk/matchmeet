    <script src="https://cdn-webgl.wrld3d.com/wrldjs/dist/latest/wrld.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.1/leaflet.css" rel="stylesheet" />
<style>
html, body {
    z-index: -10;
}
.navbar {
    opacity: 0.5;
}
</style>
<div id="front_page_map"></div>
<script>
const berkeleyLat = 37.8719;
const berkeleyLong = -122.2585;

function createMap(pos) {
  console.log(pos);
  var map = null;
  var initLat;
  var initLong;
  if (pos) {
      initLat = pos.coords.latitude;
      initLong = pos.coords.longitude;
  } else {
      initLat = berkeleyLat;
      initLong = berkeleyLong;
  }

  console.log(initLat);
  map = L.Wrld.map("front_page_map", "230f0e3aff3e146b4a87f3ebf4fcb306", {
      center: [initLat, initLong],
      zoom: 16
  })
  .themes.setTime(L.Wrld.themes.time.Dawn);
  // var times = [L.Wrld.themes.time.Dawn, L.Wrld.themes.time.Day, L.Wrld.themes.time.Dusk];
  var latlng = L.latLng(berkeleyLat, berkeleyLong);
  map.precache(latlng, 50);

  // obtain events from ruby in JSON
  var result = '[{"lat":37.8719, "long":-122.2585}, {"lat":37.8750, "long":-122.2600}]';
  eventLst = JSON.parse(result);
  for (var i = 0; i < eventLst.length; i++) {
      var e = eventLst[i];
      console.log(e);
      var lat = e.lat;
      var long = e.long;
      var marker = L.marker([lat, long], {
          title: "Transamerica Pyramid",
          opacity: 0.8
      }).bindTooltip("Event name", {
          permanent: true,
          direction: 'top',
          offset: L.point(0, -50),
          classname: "event_marker"
      }).bindPopup("This is the Transamerica Pyramid")//.openPopup()
      .on('mouseover', function (e) {
          this.openPopup();
      })
      .on('mouseout', function (e) {
          this.closePopup();
      })
      .addTo(map);
  }
}

var main = function() {
  // if (navigator.geolocation) {
  //     console.log("ask geolocation permis");
  //     navigator.geolocation.getCurrentPosition(createMap, createMap);
  // } else {
  //     createMap(null);
  // }
  createMap(null);
};


main();
</script>

<div class= "container">
<h1>Groups Near You</h1>

<div class="posts-wrapper row">
  <% @groups.each do |group| %>
    <div class="post">
      <div class="post-head">
        <div class="name">
          <%= link_to group.name, group_path(group) %>
        </div>
      </div>
      <p class="caption">
        <%= group.category %>
      </p>
    </div>
  <% end %>
</div>
</div>
